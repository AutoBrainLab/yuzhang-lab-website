{{/* Show related/recommended content with language filtering */}}
{{ if .Params.show_related }}
  {{/* Filter related pages by current language */}}
  {{ $related := site.RegularPages.Related . | first 10 }}
  {{ $filtered := slice }}
  {{ range $related }}
    {{ if eq .Lang $.Lang }}
      {{ $filtered = $filtered | append . }}
    {{ end }}
  {{ end }}
  {{ $filtered = first 5 $filtered }}
  
  {{ with $filtered }}
  <div class="article-widget content-widget-hr">
    <h3>{{ i18n "related" }}</h3>
    <ul>
      {{ range . }}
      <li><a href="{{ .RelPermalink }}">{{ .Title }}</a></li>
      {{ end }}
    </ul>
  </div>
  {{ end }}
{{ end }}
